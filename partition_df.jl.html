<!DOCTYPE html>
            <html lang="en">
            <head>
                <meta name="viewport" content="width=device-width" />
                <title>⚡ Pluto.jl ⚡</title>
                <meta charset="utf-8" />

                <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.12.16/frontend/editor.css" type="text/css" />
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.12.16/frontend/treeview.css" type="text/css" />
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.12.16/frontend/hide-ui.css" type="text/css" />
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.58.1/lib/codemirror.min.css" type="text/css" />

                <style id="MJX-SVG-styles">
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}
</style>
            </head>
            <body>
                <main><preamble><button class="runallchanged" title="Save and run all changed cells"><span></span></button></preamble><pluto-notebook id="6edc33e0-376d-11eb-3f59-97b39a21fd8e"><pluto-cell class="code_folded " id="9fa0ff60-3772-11eb-093f-754f0f57bceb"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="rich_output " mime="text/html"><assignee></assignee><div><div class="markdown"><h1>Example Notebook for <code>partition_df</code></h1>
<p>Requires <code>DataFrames</code>, <code>Random</code></p>
</div></div></pluto-output><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">15.0&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="9c3596a0-376e-11eb-3d4f-15b1c3f63cb6"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="scroll_y rich_output " mime="text/plain"><assignee></assignee><div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 217.55px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -14px; border-right-width: 36px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like">x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 187.55px; top: 0px; height: 15.2px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">using</span> <span class="cm-variable">DataFrames</span>, <span class="cm-variable">Random</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 36px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 59px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">7.2&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="cd90a420-3772-11eb-023a-65e076247568"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="rich_output " mime="text/html"><assignee></assignee><div><div class="markdown"><p>Let's say you have some data in a <code>DataFrame</code>:</p>
</div></div></pluto-output><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">8.0&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="af265fae-376e-11eb-201b-8151f3088b27"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="scroll_y " mime="application/vnd.pluto.table+object"><assignee>df</assignee> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>1</pre></td><td><pre>"1"</pre></td></tr><tr><th>2</th><td><pre>2</pre></td><td><pre>"2"</pre></td></tr><tr><th>3</th><td><pre>3</pre></td><td><pre>"3"</pre></td></tr><tr><th>4</th><td><pre>4</pre></td><td><pre>"4"</pre></td></tr><tr><th>5</th><td><pre>5</pre></td><td><pre>"5"</pre></td></tr><tr><th>6</th><td><pre>6</pre></td><td><pre>"6"</pre></td></tr><tr><th>7</th><td><pre>7</pre></td><td><pre>"7"</pre></td></tr><tr><th>8</th><td><pre>8</pre></td><td><pre>"8"</pre></td></tr><tr><th>9</th><td><pre>9</pre></td><td><pre>"9"</pre></td></tr><tr><th>10</th><td><pre>10</pre></td><td><pre>"10"</pre></td></tr><tr><td class="jlmore-td" colspan="999"><jlmore class="">more</jlmore></td></tr><tr><th>49</th><td><pre>49</pre></td><td><pre>"49"</pre></td></tr></tbody></table></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 34px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -14px; border-right-width: 36px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like">x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 15.2px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> <span class="cm-operator">=</span> <span class="cm-builtin">DataFrame</span>(<span class="cm-builtin">:foo</span> <span class="cm-operator">=&gt;</span> [<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">49</span><span class="cm-operator">...</span>], <span class="cm-builtin">:bar</span> <span class="cm-operator">=&gt;</span> [<span class="cm-string">"$i"</span> <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-operator">in</span> <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">49</span>])</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 36px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 59px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">58.1&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="db8e7d40-3772-11eb-2a2b-d5db714e8a4e"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="rich_output " mime="text/html"><assignee></assignee><div><div class="markdown"><p>and now you want to break that up into chunks of similar size.</p>
<p>Here's a function for that:</p>
</div></div></pluto-output><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">6.0&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="b5feb170-376e-11eb-146d-592e2d50d07a"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="scroll_y " mime="text/plain"><assignee></assignee><div><pre><code>partition_df (generic function with 1 method)</code></pre></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 172.2px; left: 439.337px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -14px; border-right-width: 36px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like">x</pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>10</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>8</div></div><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>10</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 409.337px; top: 167.2px; height: 15.2px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">partition_df</span>(<span class="cm-variable">df</span><span class="cm-builtin">::DataFrame</span>; </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">blocksize</span><span class="cm-builtin">::Int</span><span class="cm-operator">=</span><span class="cm-number">0</span>, <span class="cm-variable">n_partitions</span><span class="cm-builtin">::Int</span><span class="cm-operator">=</span><span class="cm-number">0</span>, <span class="cm-variable">copy</span><span class="cm-builtin">::Bool</span><span class="cm-operator">=</span><span class="cm-builtin">false</span>, </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">shuffle</span><span class="cm-builtin">::Bool</span><span class="cm-operator">=</span><span class="cm-builtin">false</span>)<span class="cm-builtin">::Array{DataFrame}</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment"># get the list of indices in the array</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">n_rows</span> <span class="cm-operator">=</span> <span class="cm-builtin">nrow</span>(<span class="cm-variable">df</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">ids</span> <span class="cm-operator">=</span> [<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-variable">n_rows</span><span class="cm-operator">...</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment"># copy the df if copy == true</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">df</span> <span class="cm-operator">=</span> <span class="cm-variable">copy</span> <span class="cm-operator">?</span> <span class="cm-builtin">deepcopy</span>(<span class="cm-variable">df</span>) <span class="cm-operator">:</span> <span class="cm-variable">df</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment"># shuffle the ids if shuffle == true</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">ids</span> <span class="cm-operator">=</span> <span class="cm-variable">shuffle</span> <span class="cm-operator">?</span> <span class="cm-builtin">randperm</span>(<span class="cm-builtin">length</span>(<span class="cm-variable">ids</span>)) <span class="cm-operator">:</span> <span class="cm-variable">ids</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">if</span> <span class="cm-variable">n_partitions</span> <span class="cm-operator">&gt;</span> <span class="cm-number">0</span> <span class="cm-comment"># if partitioning by number of partitions</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">blocksize</span> <span class="cm-operator">=</span> <span class="cm-builtin">Int</span>(<span class="cm-builtin">round</span>(<span class="cm-variable">n_rows</span> <span class="cm-operator">/</span> <span class="cm-variable">n_partitions</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">elseif</span> <span class="cm-variable">blocksize</span> <span class="cm-operator">==</span> <span class="cm-number">0</span> <span class="cm-comment"># neither blocksize nor n_partitions</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-meta">@error</span> <span class="cm-string">"Specify blocksize or n_partitions &gt; 0"</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">end</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment"># partition the dataframe</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">return</span> [<span class="cm-variable">df</span>[<span class="cm-variable">p</span>, <span class="cm-operator">:</span>] <span class="cm-keyword">for</span> <span class="cm-variable">p</span> <span class="cm-operator">∈</span> <span class="cm-builtin">collect</span>(<span class="cm-variable">Iterators</span><span class="cm-operator">.</span><span class="cm-builtin">partition</span>(<span class="cm-variable">ids</span>, <span class="cm-variable">blocksize</span>))]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">end</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 36px; width: 1px; border-bottom: 0px solid transparent; top: 282px;"></div><div class="CodeMirror-gutters" style="height: 318px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">115&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="c5971900-3774-11eb-2367-1b011d720b43"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="rich_output " mime="text/html"><assignee></assignee><div><div class="markdown"><p>Here's a bunch of examples of how to use it.  Note that any time there is a remainder after dividing up the rows, it goes into an extra partition.</p>
</div></div></pluto-output><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">6.6&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="1f44760e-376f-11eb-3e0c-bd11de3a2c8a"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="application/vnd.pluto.tree+object"><assignee></assignee><div><jltree class="collapsed">DataFrames.DataFrame<jlarray class="Array"><r><k>1</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>1</pre></td><td><pre>"1"</pre></td></tr><tr><th>2</th><td><pre>2</pre></td><td><pre>"2"</pre></td></tr><tr><th>3</th><td><pre>3</pre></td><td><pre>"3"</pre></td></tr><tr><th>4</th><td><pre>4</pre></td><td><pre>"4"</pre></td></tr><tr><th>5</th><td><pre>5</pre></td><td><pre>"5"</pre></td></tr><tr><th>6</th><td><pre>6</pre></td><td><pre>"6"</pre></td></tr><tr><th>7</th><td><pre>7</pre></td><td><pre>"7"</pre></td></tr><tr><th>8</th><td><pre>8</pre></td><td><pre>"8"</pre></td></tr><tr><th>9</th><td><pre>9</pre></td><td><pre>"9"</pre></td></tr><tr><th>10</th><td><pre>10</pre></td><td><pre>"10"</pre></td></tr></tbody></table></v></r><r><k>2</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>11</pre></td><td><pre>"11"</pre></td></tr><tr><th>2</th><td><pre>12</pre></td><td><pre>"12"</pre></td></tr><tr><th>3</th><td><pre>13</pre></td><td><pre>"13"</pre></td></tr><tr><th>4</th><td><pre>14</pre></td><td><pre>"14"</pre></td></tr><tr><th>5</th><td><pre>15</pre></td><td><pre>"15"</pre></td></tr><tr><th>6</th><td><pre>16</pre></td><td><pre>"16"</pre></td></tr><tr><th>7</th><td><pre>17</pre></td><td><pre>"17"</pre></td></tr><tr><th>8</th><td><pre>18</pre></td><td><pre>"18"</pre></td></tr><tr><th>9</th><td><pre>19</pre></td><td><pre>"19"</pre></td></tr><tr><th>10</th><td><pre>20</pre></td><td><pre>"20"</pre></td></tr></tbody></table></v></r><r><k>3</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>21</pre></td><td><pre>"21"</pre></td></tr><tr><th>2</th><td><pre>22</pre></td><td><pre>"22"</pre></td></tr><tr><th>3</th><td><pre>23</pre></td><td><pre>"23"</pre></td></tr><tr><th>4</th><td><pre>24</pre></td><td><pre>"24"</pre></td></tr><tr><th>5</th><td><pre>25</pre></td><td><pre>"25"</pre></td></tr><tr><th>6</th><td><pre>26</pre></td><td><pre>"26"</pre></td></tr><tr><th>7</th><td><pre>27</pre></td><td><pre>"27"</pre></td></tr><tr><th>8</th><td><pre>28</pre></td><td><pre>"28"</pre></td></tr><tr><th>9</th><td><pre>29</pre></td><td><pre>"29"</pre></td></tr><tr><th>10</th><td><pre>30</pre></td><td><pre>"30"</pre></td></tr></tbody></table></v></r><r><k>4</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>31</pre></td><td><pre>"31"</pre></td></tr><tr><th>2</th><td><pre>32</pre></td><td><pre>"32"</pre></td></tr><tr><th>3</th><td><pre>33</pre></td><td><pre>"33"</pre></td></tr><tr><th>4</th><td><pre>34</pre></td><td><pre>"34"</pre></td></tr><tr><th>5</th><td><pre>35</pre></td><td><pre>"35"</pre></td></tr><tr><th>6</th><td><pre>36</pre></td><td><pre>"36"</pre></td></tr><tr><th>7</th><td><pre>37</pre></td><td><pre>"37"</pre></td></tr><tr><th>8</th><td><pre>38</pre></td><td><pre>"38"</pre></td></tr><tr><th>9</th><td><pre>39</pre></td><td><pre>"39"</pre></td></tr><tr><th>10</th><td><pre>40</pre></td><td><pre>"40"</pre></td></tr></tbody></table></v></r><r><k>5</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>41</pre></td><td><pre>"41"</pre></td></tr><tr><th>2</th><td><pre>42</pre></td><td><pre>"42"</pre></td></tr><tr><th>3</th><td><pre>43</pre></td><td><pre>"43"</pre></td></tr><tr><th>4</th><td><pre>44</pre></td><td><pre>"44"</pre></td></tr><tr><th>5</th><td><pre>45</pre></td><td><pre>"45"</pre></td></tr><tr><th>6</th><td><pre>46</pre></td><td><pre>"46"</pre></td></tr><tr><th>7</th><td><pre>47</pre></td><td><pre>"47"</pre></td></tr><tr><th>8</th><td><pre>48</pre></td><td><pre>"48"</pre></td></tr><tr><th>9</th><td><pre>49</pre></td><td><pre>"49"</pre></td></tr></tbody></table></v></r></jlarray></jltree></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 286.337px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -14px; border-right-width: 36px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like">x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 256.337px; top: 0px; height: 15.2px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># break df into chunks of 10 rows</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">partition_df</span>(<span class="cm-variable">df</span>, <span class="cm-variable">blocksize</span><span class="cm-operator">=</span><span class="cm-number">10</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 36px; width: 1px; border-bottom: 0px solid transparent; top: 38px;"></div><div class="CodeMirror-gutters" style="height: 74px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">69.4&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="d4179700-3771-11eb-3529-8f7bf4423a3e"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="application/vnd.pluto.tree+object"><assignee></assignee><div><jltree class="collapsed">DataFrames.DataFrame<jlarray class="Array"><r><k>1</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>1</pre></td><td><pre>"1"</pre></td></tr><tr><th>2</th><td><pre>2</pre></td><td><pre>"2"</pre></td></tr><tr><th>3</th><td><pre>3</pre></td><td><pre>"3"</pre></td></tr><tr><th>4</th><td><pre>4</pre></td><td><pre>"4"</pre></td></tr><tr><th>5</th><td><pre>5</pre></td><td><pre>"5"</pre></td></tr><tr><th>6</th><td><pre>6</pre></td><td><pre>"6"</pre></td></tr><tr><th>7</th><td><pre>7</pre></td><td><pre>"7"</pre></td></tr><tr><th>8</th><td><pre>8</pre></td><td><pre>"8"</pre></td></tr><tr><th>9</th><td><pre>9</pre></td><td><pre>"9"</pre></td></tr><tr><th>10</th><td><pre>10</pre></td><td><pre>"10"</pre></td></tr></tbody></table></v></r><r><k>2</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>11</pre></td><td><pre>"11"</pre></td></tr><tr><th>2</th><td><pre>12</pre></td><td><pre>"12"</pre></td></tr><tr><th>3</th><td><pre>13</pre></td><td><pre>"13"</pre></td></tr><tr><th>4</th><td><pre>14</pre></td><td><pre>"14"</pre></td></tr><tr><th>5</th><td><pre>15</pre></td><td><pre>"15"</pre></td></tr><tr><th>6</th><td><pre>16</pre></td><td><pre>"16"</pre></td></tr><tr><th>7</th><td><pre>17</pre></td><td><pre>"17"</pre></td></tr><tr><th>8</th><td><pre>18</pre></td><td><pre>"18"</pre></td></tr><tr><th>9</th><td><pre>19</pre></td><td><pre>"19"</pre></td></tr><tr><th>10</th><td><pre>20</pre></td><td><pre>"20"</pre></td></tr></tbody></table></v></r><r><k>3</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>21</pre></td><td><pre>"21"</pre></td></tr><tr><th>2</th><td><pre>22</pre></td><td><pre>"22"</pre></td></tr><tr><th>3</th><td><pre>23</pre></td><td><pre>"23"</pre></td></tr><tr><th>4</th><td><pre>24</pre></td><td><pre>"24"</pre></td></tr><tr><th>5</th><td><pre>25</pre></td><td><pre>"25"</pre></td></tr><tr><th>6</th><td><pre>26</pre></td><td><pre>"26"</pre></td></tr><tr><th>7</th><td><pre>27</pre></td><td><pre>"27"</pre></td></tr><tr><th>8</th><td><pre>28</pre></td><td><pre>"28"</pre></td></tr><tr><th>9</th><td><pre>29</pre></td><td><pre>"29"</pre></td></tr><tr><th>10</th><td><pre>30</pre></td><td><pre>"30"</pre></td></tr></tbody></table></v></r><r><k>4</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>31</pre></td><td><pre>"31"</pre></td></tr><tr><th>2</th><td><pre>32</pre></td><td><pre>"32"</pre></td></tr><tr><th>3</th><td><pre>33</pre></td><td><pre>"33"</pre></td></tr><tr><th>4</th><td><pre>34</pre></td><td><pre>"34"</pre></td></tr><tr><th>5</th><td><pre>35</pre></td><td><pre>"35"</pre></td></tr><tr><th>6</th><td><pre>36</pre></td><td><pre>"36"</pre></td></tr><tr><th>7</th><td><pre>37</pre></td><td><pre>"37"</pre></td></tr><tr><th>8</th><td><pre>38</pre></td><td><pre>"38"</pre></td></tr><tr><th>9</th><td><pre>39</pre></td><td><pre>"39"</pre></td></tr><tr><th>10</th><td><pre>40</pre></td><td><pre>"40"</pre></td></tr></tbody></table></v></r><r><k>5</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>41</pre></td><td><pre>"41"</pre></td></tr><tr><th>2</th><td><pre>42</pre></td><td><pre>"42"</pre></td></tr><tr><th>3</th><td><pre>43</pre></td><td><pre>"43"</pre></td></tr><tr><th>4</th><td><pre>44</pre></td><td><pre>"44"</pre></td></tr><tr><th>5</th><td><pre>45</pre></td><td><pre>"45"</pre></td></tr><tr><th>6</th><td><pre>46</pre></td><td><pre>"46"</pre></td></tr><tr><th>7</th><td><pre>47</pre></td><td><pre>"47"</pre></td></tr><tr><th>8</th><td><pre>48</pre></td><td><pre>"48"</pre></td></tr><tr><th>9</th><td><pre>49</pre></td><td><pre>"49"</pre></td></tr></tbody></table></v></r></jlarray></jltree></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 20.2px; left: 477.488px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -14px; border-right-width: 36px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like">x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 447.488px; top: 15.2px; height: 15.2px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># break into chunks of 10 rows, and make sure the data aren't references</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># (otherwise, changing these dfs could affect the original)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">partition_df</span>(<span class="cm-variable">df</span>, <span class="cm-variable">blocksize</span><span class="cm-operator">=</span><span class="cm-number">10</span>, <span class="cm-variable">copy</span><span class="cm-operator">=</span><span class="cm-builtin">true</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 36px; width: 1px; border-bottom: 0px solid transparent; top: 54px;"></div><div class="CodeMirror-gutters" style="height: 90px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">94.5&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="da3d3a90-3771-11eb-2962-a14d637e4b94"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="application/vnd.pluto.tree+object"><assignee></assignee><div><jltree class="collapsed">DataFrames.DataFrame<jlarray class="Array"><r><k>1</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>32</pre></td><td><pre>"32"</pre></td></tr><tr><th>2</th><td><pre>34</pre></td><td><pre>"34"</pre></td></tr><tr><th>3</th><td><pre>27</pre></td><td><pre>"27"</pre></td></tr><tr><th>4</th><td><pre>22</pre></td><td><pre>"22"</pre></td></tr><tr><th>5</th><td><pre>37</pre></td><td><pre>"37"</pre></td></tr><tr><th>6</th><td><pre>41</pre></td><td><pre>"41"</pre></td></tr><tr><th>7</th><td><pre>12</pre></td><td><pre>"12"</pre></td></tr><tr><th>8</th><td><pre>43</pre></td><td><pre>"43"</pre></td></tr><tr><th>9</th><td><pre>7</pre></td><td><pre>"7"</pre></td></tr><tr><th>10</th><td><pre>30</pre></td><td><pre>"30"</pre></td></tr></tbody></table></v></r><r><k>2</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>5</pre></td><td><pre>"5"</pre></td></tr><tr><th>2</th><td><pre>10</pre></td><td><pre>"10"</pre></td></tr><tr><th>3</th><td><pre>35</pre></td><td><pre>"35"</pre></td></tr><tr><th>4</th><td><pre>24</pre></td><td><pre>"24"</pre></td></tr><tr><th>5</th><td><pre>17</pre></td><td><pre>"17"</pre></td></tr><tr><th>6</th><td><pre>25</pre></td><td><pre>"25"</pre></td></tr><tr><th>7</th><td><pre>19</pre></td><td><pre>"19"</pre></td></tr><tr><th>8</th><td><pre>9</pre></td><td><pre>"9"</pre></td></tr><tr><th>9</th><td><pre>48</pre></td><td><pre>"48"</pre></td></tr><tr><th>10</th><td><pre>2</pre></td><td><pre>"2"</pre></td></tr></tbody></table></v></r><r><k>3</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>39</pre></td><td><pre>"39"</pre></td></tr><tr><th>2</th><td><pre>26</pre></td><td><pre>"26"</pre></td></tr><tr><th>3</th><td><pre>6</pre></td><td><pre>"6"</pre></td></tr><tr><th>4</th><td><pre>46</pre></td><td><pre>"46"</pre></td></tr><tr><th>5</th><td><pre>14</pre></td><td><pre>"14"</pre></td></tr><tr><th>6</th><td><pre>11</pre></td><td><pre>"11"</pre></td></tr><tr><th>7</th><td><pre>8</pre></td><td><pre>"8"</pre></td></tr><tr><th>8</th><td><pre>15</pre></td><td><pre>"15"</pre></td></tr><tr><th>9</th><td><pre>23</pre></td><td><pre>"23"</pre></td></tr><tr><th>10</th><td><pre>28</pre></td><td><pre>"28"</pre></td></tr></tbody></table></v></r><r><k>4</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>47</pre></td><td><pre>"47"</pre></td></tr><tr><th>2</th><td><pre>45</pre></td><td><pre>"45"</pre></td></tr><tr><th>3</th><td><pre>38</pre></td><td><pre>"38"</pre></td></tr><tr><th>4</th><td><pre>49</pre></td><td><pre>"49"</pre></td></tr><tr><th>5</th><td><pre>21</pre></td><td><pre>"21"</pre></td></tr><tr><th>6</th><td><pre>1</pre></td><td><pre>"1"</pre></td></tr><tr><th>7</th><td><pre>40</pre></td><td><pre>"40"</pre></td></tr><tr><th>8</th><td><pre>16</pre></td><td><pre>"16"</pre></td></tr><tr><th>9</th><td><pre>4</pre></td><td><pre>"4"</pre></td></tr><tr><th>10</th><td><pre>31</pre></td><td><pre>"31"</pre></td></tr></tbody></table></v></r><r><k>5</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>33</pre></td><td><pre>"33"</pre></td></tr><tr><th>2</th><td><pre>20</pre></td><td><pre>"20"</pre></td></tr><tr><th>3</th><td><pre>13</pre></td><td><pre>"13"</pre></td></tr><tr><th>4</th><td><pre>42</pre></td><td><pre>"42"</pre></td></tr><tr><th>5</th><td><pre>29</pre></td><td><pre>"29"</pre></td></tr><tr><th>6</th><td><pre>44</pre></td><td><pre>"44"</pre></td></tr><tr><th>7</th><td><pre>18</pre></td><td><pre>"18"</pre></td></tr><tr><th>8</th><td><pre>3</pre></td><td><pre>"3"</pre></td></tr><tr><th>9</th><td><pre>36</pre></td><td><pre>"36"</pre></td></tr></tbody></table></v></r></jlarray></jltree></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 293.988px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -14px; border-right-width: 36px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 263.988px; top: 0px; height: 15.2px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 10-row blocks with randomization</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">partition_df</span>(<span class="cm-variable">df</span>, <span class="cm-variable">blocksize</span><span class="cm-operator">=</span><span class="cm-number">10</span>, <span class="cm-variable">shuffle</span><span class="cm-operator">=</span><span class="cm-builtin">true</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 36px; width: 1px; border-bottom: 0px solid transparent; top: 38px;"></div><div class="CodeMirror-gutters" style="height: 74px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">64.5&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="7b04d3a0-3774-11eb-1a2d-b533ba59e60b"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="application/vnd.pluto.tree+object"><assignee></assignee><div><jltree class="collapsed">DataFrames.DataFrame<jlarray class="Array"><r><k>1</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>1</pre></td><td><pre>"1"</pre></td></tr><tr><th>2</th><td><pre>2</pre></td><td><pre>"2"</pre></td></tr><tr><th>3</th><td><pre>3</pre></td><td><pre>"3"</pre></td></tr><tr><th>4</th><td><pre>4</pre></td><td><pre>"4"</pre></td></tr><tr><th>5</th><td><pre>5</pre></td><td><pre>"5"</pre></td></tr><tr><th>6</th><td><pre>6</pre></td><td><pre>"6"</pre></td></tr><tr><th>7</th><td><pre>7</pre></td><td><pre>"7"</pre></td></tr><tr><th>8</th><td><pre>8</pre></td><td><pre>"8"</pre></td></tr><tr><th>9</th><td><pre>9</pre></td><td><pre>"9"</pre></td></tr><tr><th>10</th><td><pre>10</pre></td><td><pre>"10"</pre></td></tr><tr><td class="jlmore-td" colspan="999"><jlmore class="">more</jlmore></td></tr><tr><th>16</th><td><pre>16</pre></td><td><pre>"16"</pre></td></tr></tbody></table></v></r><r><k>2</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>17</pre></td><td><pre>"17"</pre></td></tr><tr><th>2</th><td><pre>18</pre></td><td><pre>"18"</pre></td></tr><tr><th>3</th><td><pre>19</pre></td><td><pre>"19"</pre></td></tr><tr><th>4</th><td><pre>20</pre></td><td><pre>"20"</pre></td></tr><tr><th>5</th><td><pre>21</pre></td><td><pre>"21"</pre></td></tr><tr><th>6</th><td><pre>22</pre></td><td><pre>"22"</pre></td></tr><tr><th>7</th><td><pre>23</pre></td><td><pre>"23"</pre></td></tr><tr><th>8</th><td><pre>24</pre></td><td><pre>"24"</pre></td></tr><tr><th>9</th><td><pre>25</pre></td><td><pre>"25"</pre></td></tr><tr><th>10</th><td><pre>26</pre></td><td><pre>"26"</pre></td></tr><tr><td class="jlmore-td" colspan="999"><jlmore class="">more</jlmore></td></tr><tr><th>16</th><td><pre>32</pre></td><td><pre>"32"</pre></td></tr></tbody></table></v></r><r><k>3</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>33</pre></td><td><pre>"33"</pre></td></tr><tr><th>2</th><td><pre>34</pre></td><td><pre>"34"</pre></td></tr><tr><th>3</th><td><pre>35</pre></td><td><pre>"35"</pre></td></tr><tr><th>4</th><td><pre>36</pre></td><td><pre>"36"</pre></td></tr><tr><th>5</th><td><pre>37</pre></td><td><pre>"37"</pre></td></tr><tr><th>6</th><td><pre>38</pre></td><td><pre>"38"</pre></td></tr><tr><th>7</th><td><pre>39</pre></td><td><pre>"39"</pre></td></tr><tr><th>8</th><td><pre>40</pre></td><td><pre>"40"</pre></td></tr><tr><th>9</th><td><pre>41</pre></td><td><pre>"41"</pre></td></tr><tr><th>10</th><td><pre>42</pre></td><td><pre>"42"</pre></td></tr><tr><td class="jlmore-td" colspan="999"><jlmore class="">more</jlmore></td></tr><tr><th>16</th><td><pre>48</pre></td><td><pre>"48"</pre></td></tr></tbody></table></v></r><r><k>4</k><v> <table class="pluto-table"><thead><tr class="schema-names"><th></th><th>foo</th><th>bar</th></tr><tr class="schema-types"><th></th><th>Int64</th><th>String</th></tr></thead><tbody><tr><th>1</th><td><pre>49</pre></td><td><pre>"49"</pre></td></tr></tbody></table></v></r></jlarray></jltree></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 370.45px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -14px; border-right-width: 36px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 340.45px; top: 0px; height: 15.2px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># break the data into 3 blocks of equal size</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">partition_df</span>(<span class="cm-variable">df</span>, <span class="cm-variable">n_partitions</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 36px; width: 1px; border-bottom: 0px solid transparent; top: 38px;"></div><div class="CodeMirror-gutters" style="height: 74px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">55.0&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell></pluto-notebook><dropruler></dropruler></main>
                <svg id="MJX-SVG-global-cache" style="display: none;"><defs></defs></svg>
            </body>
            </html>
        